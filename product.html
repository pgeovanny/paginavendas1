<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produto – PG Concursos</title>
  <meta name="description" content="Página do produto — PG Concursos – Dominando o Edital." />
  <meta name="theme-color" content="#0e1f4b" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <script src="products.js"></script>
</head>
<body>
  <a class="skip-link" href="#conteudo">Pular para o conteúdo</a>

  <header class="site-header" role="banner">
    <div class="container header-wrap">
      <a class="brand" href="index.html"><span class="brand-line brand-pg">PG Concursos</span><span class="brand-x" aria-hidden="true">×</span><span class="brand-line brand-de">Dominando o Edital</span></a>
      <nav class="nav" aria-label="Principal">
        <a class="nav-link" href="index.html#produtos">Produtos</a>
        <a class="nav-link cta-small" href="index.html#produtos">Começar</a>
      </nav>
    </div>
  </header>

  <main id="conteudo" class="product-page">
    <div class="container product-container" id="product-root" aria-live="polite">

      <!-- Header-card comum -->
      <section class="product-header-card" aria-labelledby="prod-title">
        <div class="product-body">
          <div class="back-wrap"><a class="btn btn-outline" href="index.html">← Voltar</a></div>
          <h1 class="product-title" id="prod-title">Carregando…</h1>
          <p class="product-sub" id="prod-sub"></p>
          <div class="badge-pill" id="guarantee">Compra garantida • Entrega imediata</div>

          <!-- Ações do header (mentoria usa; materiais deixam só Whats aqui) -->
          <div class="actions" id="header-actions" style="margin-top:10px;">
            <a class="btn btn-primary" id="btn-buy" href="#" target="_blank" rel="noopener">Comprar agora</a>
            <a class="btn btn-outline" id="btn-whats" href="#" target="_blank" rel="noopener">Ainda tem dúvidas? Clique aqui</a>
          </div>
        </div>
      </section>

      <!-- Copy-card (parágrafos + preço/ações no rodapé) -->
      <section class="copy-card" id="copy-card">
        <div id="copy-wrap"></div>

        <!-- Rodapé de preço/ações (somente materiais) -->
        <div class="copy-actions" id="price-actions" style="display:none;">
          <div class="price-tag" id="prod-price"></div>
          <a class="btn btn-primary" id="btn-buy-bottom" href="#" target="_blank" rel="noopener">Comprar agora</a>
          <a class="btn btn-primary" id="btn-sample" href="#" target="_blank" rel="noopener" style="display:none;">Ver amostra</a>
          <a class="btn btn-outline" id="btn-whats-bottom" href="#" target="_blank" rel="noopener">Ainda tem dúvidas? Clique aqui</a>
        </div>
      </section>

      <div class="back-wrap"><a class="btn btn-outline" href="index.html">← Voltar</a></div>
    </div>
  </main>

  <!-- FAB WhatsApp -->
  <a class="fab-whatsapp" id="fab-whats" href="#" target="_blank" rel="noopener" aria-label="Abrir WhatsApp">
    <img src="assets/whatsapp.svg" width="26" height="26" alt="WhatsApp" />
  </a>

  <!-- Overlay Mentoria -->
  <div id="comprar-root" style="display:none;">
    <div class="purchase-overlay" aria-hidden="true"></div>
    <div class="purchase-panel" role="dialog" aria-modal="true" aria-labelledby="dlg-title">
      <div class="purchase-head">
        <h3 class="purchase-title" id="dlg-title">Escolha sua mentoria</h3>
        <a class="close-x" href="#" aria-label="Fechar">✕</a>
      </div>
      <form class="stepper" onsubmit="return false;">
        <div class="stage">
          <div class="hint">1) Selecione o tipo</div>
          <input type="radio" name="tipo" id="opt-com" />
          <input type="radio" name="tipo" id="opt-sem" />
          <div class="options">
            <label for="opt-com">Mentoria com material</label>
            <label for="opt-sem">Mentoria sem material</label>
          </div>
        </div>
        <div class="stage">
          <div class="hint">2) Escolha o plano</div>
          <div class="plans-com">
            <a id="link-com-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
            <a id="link-com-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
          </div>
          <div class="plans-sem">
            <a id="link-sem-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
            <a id="link-sem-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
          </div>
        </div>
      </form>
    </div>
  </div>

  <footer class="site-footer" role="contentinfo">
    <div class="container footer-wrap">
      <small>© <span id="year"></span> PG Concursos — Dominando o Edital. Todos os direitos reservados.</small>
      <div class="footer-links"><a href="#">Termos</a><span class="sep">•</span><a href="#">Privacidade</a></div>
    </div>
  </footer>

  <script>
    const qs = (s, el=document) => el.querySelector(s);
    const enc = encodeURIComponent;
    const param = (k) => new URLSearchParams(location.search).get(k);
    qs('#year').textContent = new Date().getFullYear();

    function normalize(s){
      return (s||'').toString()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
        .toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    }
    function resolveSlug(raw){
      const n = normalize(raw);
      const alias = {
        'manual':'manual','manual-do-aprovado':'manual',
        'legislacao':'legislacao','legislacao-interna':'legislacao','legislacao-interna-tj-sp-2025':'legislacao',
        'mentoria':'mentoria'
      };
      return alias[n] || n;
    }
    function notFound(){
      qs('#product-root').innerHTML = `
        <section class="copy-card">
          <h2 class="mt-0">Produto não encontrado</h2>
          <p>Verifique o link. Você pode voltar para a página inicial e escolher novamente.</p>
          <div class="copy-actions"><a class="btn btn-primary" href="index.html">Voltar para a Home</a></div>
        </section>`;
      qs('#fab-whats').style.display = 'none';
      document.title = 'Produto não encontrado – PG Concursos';
    }

    (function init(){
      const raw = param('p');
      if (!raw || typeof window.PRODUCTS !== 'object') { notFound(); return; }
      const key = resolveSlug(raw);
      const data = window.PRODUCTS[key];
      if (!data) { notFound(); return; }

      document.title = `${data.title} – PG Concursos`;

      // WhatsApp (comum)
      const waNum = data.whatsNumber || '';
      const waMsg = data.whatsMessage || `Tenho dúvidas sobre ${data.title}`;
      const waLink = waNum ? `https://wa.me/${waNum}?text=${enc(waMsg)}` : '#';
      qs('#fab-whats').href = waLink;
      qs('#btn-whats').href = waLink;
      qs('#btn-whats-bottom').href = waLink;

      // Header
      qs('#prod-title').textContent = data.title;
      qs('#prod-sub').textContent = data.subtitle || '';

      // Copy em card (sempre justificada)
      const copyWrap = qs('#copy-wrap'); copyWrap.innerHTML = '';
      (data.copy || []).forEach(txt => {
        const p = document.createElement('p'); p.textContent = txt; copyWrap.appendChild(p);
      });

      if (data.type === 'mentoria') {
        // Mostrar overlay e esconder preço/ações do copy
        const comprarRoot = qs('#comprar-root'); comprarRoot.id = 'comprar'; comprarRoot.style.display = 'block';
        qs('#btn-buy').href = '#comprar';
        qs('#price-actions').style.display = 'none';
        // Mentoria não usa "Ver amostra"
        qs('#btn-sample').style.display = 'none';
        // Planos
        qs('#link-com-mensal').href = data.checkout?.com?.mensal || '#';
        qs('#link-com-trimestral').href = data.checkout?.com?.trimestral || '#';
        qs('#link-sem-mensal').href = data.checkout?.sem?.mensal || '#';
        qs('#link-sem-trimestral').href = data.checkout?.sem?.trimestral || '#';
      } else {
        // Materiais: preço + CTAs ficam NO RODAPÉ DO COPY-CARD
        qs('#price-actions').style.display = 'flex';
        if (data.price) qs('#prod-price').textContent = data.price;
        qs('#btn-buy').style.display = 'none'; // header não precisa CTA primário nos materiais
        qs('#btn-buy-bottom').href = data.checkoutUrl || '#';
        if (data.sampleUrl){ qs('#btn-sample').href = data.sampleUrl; qs('#btn-sample').style.display = 'inline-flex'; }
      }
    })();
  </script>
</body>
</html>
