<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produto – PG Concursos</title>
  <meta name="description" content="Página do produto — PG Concursos – Dominando o Edital." />
  <meta name="theme-color" content="#0e1f4b" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <script src="products.js" defer></script>
</head>
<body>
  <a class="skip-link" href="#conteudo">Pular para o conteúdo</a>

  <!-- Header fixo -->
  <header class="site-header" role="banner" aria-label="Cabeçalho">
    <div class="container header-wrap">
      <a class="brand" href="index.html" aria-label="Ir para a página inicial">
        <span class="brand-line brand-pg">PG Concursos</span>
        <span class="brand-x" aria-hidden="true">×</span>
        <span class="brand-line brand-de">Dominando o Edital</span>
      </a>
      <nav class="nav" aria-label="Principal">
        <a class="nav-link" href="index.html#produtos">Produtos</a>
        <a class="nav-link" href="index.html#sobre">Sobre</a>
        <a class="nav-link cta-small" href="index.html#produtos">Começar</a>
      </nav>
    </div>
  </header>

  <main id="conteudo" class="product-page">
    <div class="container product-wrap" id="product-root" aria-live="polite">
      <!-- Coluna imagem -->
      <div>
        <div class="mock-image" id="prod-image" role="img" aria-label="Imagem ilustrativa do produto"></div>
      </div>

      <!-- Coluna conteúdo -->
      <div>
        <div class="back-wrap">
          <a class="btn btn-outline" href="index.html">← Voltar</a>
        </div>

        <h1 class="product-title" id="prod-title">Carregando…</h1>
        <p class="product-sub" id="prod-sub"></p>

        <div class="price-tag" id="prod-price" style="display:none;"></div>

        <article class="copy" aria-label="Descrição detalhada do produto">
          <div id="prod-copy"></div>

          <div class="note-secure" id="prod-secure">
            Compra segura: pagamento processado em ambiente externo confiável, com confirmação por e-mail. Suporte por WhatsApp para qualquer dúvida.
          </div>

          <div class="actions">
            <a class="btn btn-primary" id="btn-buy" href="#" target="_blank" rel="noopener">Comprar agora</a>
            <a class="btn btn-outline" id="btn-whats" href="#" target="_blank" rel="noopener">Ainda tem dúvidas? Clique aqui</a>
          </div>
        </article>

        <div class="back-wrap">
          <a class="btn btn-outline" href="index.html">← Voltar</a>
        </div>
      </div>
    </div>
  </main>

  <!-- Botão flutuante do WhatsApp (só nas páginas de produto) -->
  <a class="fab-whatsapp" id="fab-whats" href="#" target="_blank" rel="noopener" aria-label="Abrir WhatsApp">
    <img src="assets/whatsapp.svg" width="26" height="26" alt="WhatsApp" />
  </a>

  <!-- Overlay/Stepper para Mentoria (CSS-only; ativado via #comprar) -->
  <div id="comprar-root" style="display:none;">
    <div class="purchase-overlay"></div>
    <div class="purchase-panel">
      <div class="purchase-head">
        <h3 class="purchase-title">Escolha sua mentoria</h3>
        <a class="close-x" href="#" aria-label="Fechar">✕</a>
      </div>

      <form class="stepper" onsubmit="return false;">
        <!-- Etapa 1 -->
        <div class="stage">
          <div class="hint">1) Selecione o tipo</div>
          <input type="radio" name="tipo" id="opt-com" />
          <input type="radio" name="tipo" id="opt-sem" />
          <div class="options">
            <label for="opt-com">Mentoria com material</label>
            <label for="opt-sem">Mentoria sem material</label>
          </div>
        </div>

        <!-- Etapa 2 -->
        <div class="stage">
          <div class="hint">2) Escolha o plano</div>

          <div class="plans-com">
            <a id="link-com-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
            <a id="link-com-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
          </div>

          <div class="plans-sem">
            <a id="link-sem-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
            <a id="link-sem-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Rodapé -->
  <footer class="site-footer" role="contentinfo">
    <div class="container footer-wrap">
      <small>© <span id="year"></span> PG Concursos — Dominando o Edital. Todos os direitos reservados.</small>
      <div class="footer-links">
        <a href="#" aria-label="Termos de uso">Termos</a>
        <span class="sep">•</span>
        <a href="#" aria-label="Política de privacidade">Privacidade</a>
      </div>
    </div>
  </footer>

  <script>
    // util
    const qs = (s, el=document) => el.querySelector(s);
    const qsp = (s, el=document) => el.querySelectorAll(s);
    const param = (k) => new URLSearchParams(location.search).get(k);

    function encodeWhats(msg){ return encodeURIComponent(msg); }

    function notFound() {
      qs('#product-root').innerHTML = `
        <div class="copy" style="grid-column: 1 / -1;">
          <h2 class="mt-0">Produto não encontrado</h2>
          <p class="mt-8">Verifique o link. Você pode voltar para a página inicial e escolher novamente.</p>
          <div class="actions">
            <a class="btn btn-primary" href="index.html">Voltar para a Home</a>
          </div>
        </div>`;
      qs('#fab-whats').style.display = 'none';
      document.title = 'Produto não encontrado – PG Concursos';
    }

    document.addEventListener('DOMContentLoaded', () => {
      const slug = (param('p') || '').toLowerCase();
      if (!window.PRODUCTS || !slug || !window.PRODUCTS[slug]) {
        notFound(); return;
      }

      const data = window.PRODUCTS[slug];

      // SEO básico
      document.title = `${data.title} – PG Concursos`;

      // Preenche campos
      qs('#prod-title').textContent = data.title;
      qs('#prod-sub').textContent = data.subtitle;

      if (data.price) {
        qs('#prod-price').style.display = 'block';
        qs('#prod-price').textContent = data.price;
      }

      // Copy (parágrafos)
      const copyEl = qs('#prod-copy');
      copyEl.innerHTML = '';
      (data.copy || []).forEach(par => {
        const p = document.createElement('p');
        p.textContent = par;
        copyEl.appendChild(p);
      });

      // WhatsApp
      const waMsg = data.whatsMessage || `Tenho dúvidas sobre ${data.title}`;
      const waLink = `https://wa.me/${data.whatsNumber}?text=${encodeWhats(waMsg)}`;
      qs('#btn-whats').href = waLink;
      qs('#fab-whats').href = waLink;

      const buyBtn = qs('#btn-buy');

      if (data.type === 'mentoria') {
        // Botão abre overlay via âncora #comprar
        buyBtn.removeAttribute('target');
        buyBtn.removeAttribute('rel');
        buyBtn.href = '#comprar';
        // Exibe bloco do overlay
        const comprarRoot = qs('#comprar-root');
        comprarRoot.id = 'comprar'; // para acionar o CSS :target
        comprarRoot.style.display = 'block';

        // Preenche links dos planos
        qs('#link-com-mensal').href = data.checkout?.com?.mensal || '#';
        qs('#link-com-trimestral').href = data.checkout?.com?.trimestral || '#';
        qs('#link-sem-mensal').href = data.checkout?.sem?.mensal || '#';
        qs('#link-sem-trimestral').href = data.checkout?.sem?.trimestral || '#';
      } else {
        // Link direto para checkout
        buyBtn.href = data.checkoutUrl || '#';
      }
    });

    // Ano no rodapé
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
