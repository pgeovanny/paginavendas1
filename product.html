<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produto – PG Concursos</title>
  <meta name="description" content="Página do produto — PG Concursos – Dominando o Edital." />
  <meta name="theme-color" content="#0e1f4b" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <script src="products.js"></script>
</head>
<body>
  <a class="skip-link" href="#conteudo">Pular para o conteúdo</a>

  <header class="site-header" role="banner">
    <div class="container header-wrap">
      <a class="brand" href="index.html"><span class="brand-line brand-pg">PG Concursos</span><span class="brand-x" aria-hidden="true">×</span><span class="brand-line brand-de">Dominando o Edital</span></a>
      <nav class="nav" aria-label="Principal">
        <a class="nav-link" href="index.html#produtos">Produtos</a>
        <a class="nav-link cta-small" href="index.html#produtos">Começar</a>
      </nav>
    </div>
  </header>

  <main id="conteudo" class="product-page">
    <div class="container product-container" id="product-root" aria-live="polite">

      <!-- CARD ÚNICO – Materiais -->
      <section id="material-card" class="material-card" hidden>
        <div class="material-body">
          <div class="back-wrap"><a class="btn btn-outline" href="index.html">← Voltar</a></div>
          <div class="material-head">
            <h1 id="m-title">Carregando…</h1>
            <p id="m-sub"></p>
          </div>

          <div id="m-copy" class="material-copy"></div>

          <hr class="divider" />

          <div class="price-actions">
            <div class="price-tag" id="m-price"></div>
            <a class="btn btn-primary" id="m-buy" href="#" target="_blank" rel="noopener">Comprar agora</a>
            <a class="btn btn-primary" id="m-sample" href="#" target="_blank" rel="noopener" style="display:none;">Ver amostra</a>
            <a class="btn btn-outline" id="m-whats" href="#" target="_blank" rel="noopener">Ainda tem dúvidas? Clique aqui</a>
          </div>
        </div>
      </section>

      <!-- MENTORIA (mantido) -->
      <section id="mentoria-card" class="product-header-card" hidden>
        <div class="product-body">
          <div class="back-wrap"><a class="btn btn-outline" href="index.html">← Voltar</a></div>
          <h1 class="product-title" id="t-title">Mentoria</h1>
          <p class="product-sub" id="t-sub"></p>
          <div class="actions">
            <a class="btn btn-primary" id="t-buy" href="#comprar">Comprar agora</a>
            <a class="btn btn-outline" id="t-whats" href="#" target="_blank" rel="noopener">Ainda tem dúvidas? Clique aqui</a>
          </div>
        </div>
      </section>

      <!-- Overlay da Mentoria -->
      <div id="comprar-root" style="display:none;">
        <div class="purchase-overlay" aria-hidden="true"></div>
        <div class="purchase-panel" role="dialog" aria-modal="true" aria-labelledby="dlg-title">
          <div class="purchase-head">
            <h3 class="purchase-title" id="dlg-title">Escolha sua mentoria</h3>
            <a class="close-x" href="#" aria-label="Fechar">✕</a>
          </div>
          <form class="stepper" onsubmit="return false;">
            <div class="stage">
              <div class="hint">1) Selecione o tipo</div>
              <input type="radio" name="tipo" id="opt-com" />
              <input type="radio" name="tipo" id="opt-sem" />
              <div class="options">
                <label for="opt-com">Mentoria com material</label>
                <label for="opt-sem">Mentoria sem material</label>
              </div>
            </div>
            <div class="stage">
              <div class="hint">2) Escolha o plano</div>
              <div class="plans-com">
                <a id="link-com-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
                <a id="link-com-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
              </div>
              <div class="plans-sem">
                <a id="link-sem-mensal" class="plan-link" href="#" target="_blank" rel="noopener">Plano mensal</a>
                <a id="link-sem-trimestral" class="plan-link" href="#" target="_blank" rel="noopener">Plano trimestral</a>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="back-wrap"><a class="btn btn-outline" href="index.html">← Voltar</a></div>
    </div>
  </main>

  <!-- FAB WhatsApp -->
  <a class="fab-whatsapp" id="fab-whats" href="#" target="_blank" rel="noopener" aria-label="Abrir WhatsApp">
    <img src="assets/whatsapp.svg" width="26" height="26" alt="WhatsApp" />
  </a>

  <footer class="site-footer" role="contentinfo">
    <div class="container footer-wrap">
      <small>© <span id="year"></span> PG Concursos — Dominando o Edital. Todos os direitos reservados.</small>
      <div class="footer-links"><a href="#">Termos</a><span class="sep">•</span><a href="#">Privacidade</a></div>
    </div>
  </footer>

  <script>
    const qs = (s, el=document) => el.querySelector(s);
    const enc = encodeURIComponent;
    const param = (k) => new URLSearchParams(location.search).get(k);
    qs('#year').textContent = new Date().getFullYear();

    function normalize(s){
      return (s||'').toString()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
        .toLowerCase().replace(/[^a-z0-9]+/g,'-')
        .replace(/(^-|-$)/g,'');
    }
    function resolveSlug(raw){
      const n = normalize(raw);
      const alias = {
        'manual':'manual','manual-do-aprovado':'manual',
        'legislacao':'legislacao','legislacao-interna':'legislacao','legislacao-interna-tj-sp-2025':'legislacao',
        'mentoria':'mentoria'
      };
      return alias[n] || n;
    }
    function notFound(){
      qs('#product-root').innerHTML = `
        <section class="material-card"><div class="material-body">
          <h2 class="mt-0">Produto não encontrado</h2>
          <p class="mt-8">Verifique o link. Você pode voltar para a página inicial e escolher novamente.</p>
          <div class="price-actions"><a class="btn btn-primary" href="index.html">Voltar para a Home</a></div>
        </div></section>`;
      qs('#fab-whats').style.display = 'none';
      document.title = 'Produto não encontrado – PG Concursos';
    }

    (function init(){
      const raw = param('p');
      if (!raw || typeof window.PRODUCTS !== 'object') { notFound(); return; }
      const key = resolveSlug(raw);
      const data = window.PRODUCTS[key];
      if (!data) { notFound(); return; }

      document.title = `${data.title} – PG Concursos`;

      // WhatsApp (comum)
      const waNum = data.whatsNumber || '';
      const waMsg = data.whatsMessage || `Tenho dúvidas sobre ${data.title}`;
      const waLink = waNum ? `https://wa.me/${waNum}?text=${enc(waMsg)}` : '#';
      qs('#fab-whats').href = waLink;

      if (data.type === 'mentoria') {
        // Mostrar card de mentoria + overlay
        const card = qs('#mentoria-card');
        card.hidden = false;
        qs('#t-title').textContent = data.title;
        qs('#t-sub').textContent = data.subtitle || '';
        qs('#t-whats').href = waLink;

        const comprarRoot = qs('#comprar-root'); comprarRoot.id = 'comprar'; comprarRoot.style.display = 'block';
        qs('#t-buy').href = '#comprar';
        qs('#link-com-mensal').href = data.checkout?.com?.mensal || '#';
        qs('#link-com-trimestral').href = data.checkout?.com?.trimestral || '#';
        qs('#link-sem-mensal').href = data.checkout?.sem?.mensal || '#';
        qs('#link-sem-trimestral').href = data.checkout?.sem?.trimestral || '#';
        return;
      }

      // ===== Materiais: card único =====
      const mc = qs('#material-card');
      mc.hidden = false;
      qs('#m-title').textContent = data.title;
      qs('#m-sub').textContent = data.subtitle || '';

      // Copy
      const copyEl = qs('#m-copy'); copyEl.innerHTML = '';
      (data.copy || []).forEach(txt => {
        const p = document.createElement('p');
        p.textContent = txt; copyEl.appendChild(p);
      });

      // Preço + ações
      if (data.price) qs('#m-price').textContent = data.price;
      const buy = qs('#m-buy'), sample = qs('#m-sample'), whats = qs('#m-whats');
      buy.href = data.checkoutUrl || '#';
      if (data.sampleUrl){ sample.href = data.sampleUrl; sample.style.display = 'inline-flex'; }
      whats.href = waLink;
    })();
  </script>
</body>
</html>
